(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["upload"],{"39c1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 套餐管理\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box display_flex between"},[a("div",{staticClass:"display_flex"},[a("el-input",{staticClass:"m-r-20",attrs:{placeholder:"请输入套餐名称"},model:{value:e.query.planName,callback:function(t){e.$set(e.query,"planName",t)},expression:"query.planName"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.open}},[e._v("新增")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pageAgeLoading,expression:"pageAgeLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"planName",label:"套餐名称",width:"200"}}),a("el-table-column",{attrs:{label:"套餐简介",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"less"},[e._v(e._s(t.row.planNote))])]}}])}),a("el-table-column",{attrs:{label:"套餐预览图"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"200px",height:"150px","object-fit":"contain"},attrs:{src:t.row.preview,lazy:""},on:{click:function(a){return e.showPreview(t.row)}}})]}}])}),a("el-table-column",{attrs:{label:"状态",prop:"publish",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s("0"==t.row.publish?"下架":"发布"))])]}}])}),a("el-table-column",{attrs:{label:"编辑状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.publish(t.$index,t.row)}}},[e._v(e._s("0"==t.row.publish?"发布":" 下架"))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.editClass(t.$index,t.row)}}},[e._v("编辑课程列表")]),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pageNum,"page-size":10,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{attrs:{title:"套餐",visible:e.editVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"150px",rules:e.rules}},[a("el-form-item",{attrs:{label:"套餐名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"套餐简介",prop:"note"}},[a("el-input",{attrs:{type:"textarea",resize:"none",autosize:{minRows:5}},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1),a("el-form-item",{attrs:{label:"套餐预览图",prop:"preview"}},[a("qiniuImg",{attrs:{address:e.form.preview},on:{back:e.getPreviewUrl}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:!e.isCheck,expression:"!isCheck"}],attrs:{type:"primary"},on:{click:function(t){return e.addClass("form")}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"添加测试",visible:e.testVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.testVisible=t}}},[a("el-table",{ref:"tableTest",staticClass:"table",staticStyle:{height:"300px",overflow:"auto"},attrs:{data:e.testList}},[a("el-table-column",{attrs:{prop:"name",label:"课名称",width:"300"}}),a("el-table-column",{attrs:{label:"课程节次",width:"100",prop:"lesson"}}),a("el-table-column",{attrs:{label:"单元测试",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.editSingleClass(t.row)}}},[e._v("编辑")])]}}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.editAllClass}},[e._v("编辑课程评测")])],1)],1),a("el-dialog",{staticClass:"privew-dialog",attrs:{visible:e.imgShow,width:"100%","close-on-click-modal":!1},on:{"update:visible":function(t){e.imgShow=t}}},[a("img",{staticClass:"preview-img",attrs:{src:e.currentPreview,alt:""}})]),a("teacherlist",{attrs:{show:e.showSelectTeacher},on:{close:function(t){e.showSelectTeacher=!1},select:e.selectTeacher}})],1)},i=[],s=(a("7f7f"),a("4a16")),l=a("f454"),r={components:{teacherlist:s["a"],qiniuImg:l["default"]},data:function(){return{pageAgeLoading:!1,imgShow:!1,currentPreview:"",rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],note:[{required:!0,message:"请输入简介",trigger:"blur"}],preview:[{required:!0,message:"请上传预览图",trigger:"blur"}]},query:{},form:{planId:0,name:"",note:"",preview:""},imgLoading:!1,tableData:[],testList:[],editVisible:!1,pageTotal:0,pageNum:1,showSelectTeacher:!1,testVisible:!1,testItem:"",isCheck:!0}},created:function(){this.getData({pageNum:this.pageNum,pageSize:10})},methods:{showPreview:function(e){this.currentPreview=e.preview,this.imgShow=!0},getPreviewUrl:function(e){var t=JSON.parse(JSON.stringify(this.form));t.preview=e,this.form=t},editClass:function(e,t){this.$router.push({path:"/packageClass",query:{id:t.planId,name:t.planName}})},beforeAvatarUpload:function(){this.imgLoading=!0},handleAvatarSuccess:function(e,t){var a=JSON.parse(JSON.stringify(this.form));a.preview=e.data,this.form=a,this.imgLoading=!1},openTeacher:function(e){this.showSelectTeacher=!0},selectTeacher:function(e){console.log(e);var t=JSON.parse(JSON.stringify(this.form));t.teacherId=e.id,t.selectTeacherName=e.name,this.form=t,this.showSelectTeacher=!1},publish:function(e,t){var a=this;console.log(t),0==t.publish?this.$confirm("确定要发布吗？","提示",{type:"warning"}).then((function(){var e={planId:t.planId,publish:1};a.axios.get("/manager/planManagement/publishPlan",{params:e}).then((function(e){a.$message.success("发布成功"),a.getData({pageNum:a.pageNum,pageSize:10})}))})).catch((function(){})):this.$confirm("确定要下架吗？","提示",{type:"warning"}).then((function(){var e={planId:t.planId,publish:0};a.axios.get("/manager/planManagement/publishPlan",{params:e}).then((function(e){a.$message.success("下架成功"),a.getData({pageNum:a.pageNum,pageSize:10})}))})).catch((function(){}))},getData:function(e){var t=this;this.pageAgeLoading=!0,this.axios.get("/manager/planManagement/obtainPlan",{params:e}).then((function(e){console.log(e),t.pageAgeLoading=!1,t.tableData=e.data.contents,t.pageTotal=e.data.page.total,t.pageNum=e.data.page.pageNum}))},handleSearch:function(){this.getData(this.query)},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){var e={planId:t.planId};a.axios.get("/manager/planManagement/deletePlan",{params:e}).then((function(e){a.$message.success("删除成功"),a.getData({pageNum:1,pageSize:10})}))})).catch((function(){}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this.multipleSelection.length,t="";this.delList=this.delList.concat(this.multipleSelection);for(var a=0;a<e;a++)t+=this.multipleSelection[a].name+" ";this.$message.error("删除了".concat(t)),this.multipleSelection=[]},handleEdit:function(e,t){this.editVisible=!0;var a=this.tableData[e];console.log(a);var n={planId:a.planId,name:a.planName,note:a.planNote,preview:a.preview};this.form=n},open:function(e){this.form={planId:0,name:"",note:"",preview:""},this.editVisible=!0},addClass:function(e){var t=this;this.isCheck&&(this.imgLoading?this.$message.error("正在上传中"):(this.isCheck=!1,this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),setTimeout((function(){t.isCheck=!0}),500),!1;t.axios.post("/manager/planManagement/insertPlan",t.form).then((function(e){t.$message.success(t.form.planId?"更新成功":"添加成功"),t.editVisible=!1,t.getData({pageNum:1,pageSize:10}),setTimeout((function(){t.isCheck=!0}),500)})).catch((function(e){setTimeout((function(){t.isCheck=!0}),500)}))}))))},saveEdit:function(){this.editVisible=!1,this.$message.success("修改第 ".concat(this.idx+1," 行成功")),this.$set(this.tableData,this.idx,this.form)},handlePageChange:function(e){console.log(e),this.getData({pageNum:e,pageSize:10})},jump:function(e,t){console.log(e),this.$router.push({path:"/class/course",query:{id:t.courseId}})},editSingleClass:function(e){var t=e;console.log(t),this.$router.push({path:"/class/courseTest",query:{id:t.courseId,testId:t.id}})},editAllClass:function(){var e=this.testItem;this.$router.push({path:"/class/classTest",query:{id:e.courseId}})},jumpTest:function(e,t){var a=this,n=t.courseId;this.testItem=t,this.testVisible=!0,this.axios.get("/manager/courseManagement/obtainCourseCatalog",{params:{courseId:n}}).then((function(e){a.testList=e.data}))}}},o=r,c=(a("959c"),a("2877")),u=Object(c["a"])(o,n,i,!1,null,"ff4d1e14",null);t["default"]=u.exports},"4a16":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("div",{staticClass:"teacher-list",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeThis(t)}}},[a("div",{staticClass:"list-content"},[a("div",{staticClass:"search-input"},[a("div",{staticStyle:{"margin-right":"1rem"}},[a("el-input",{attrs:{placeholder:"请输入教师名称"},model:{value:e.teacherName,callback:function(t){e.teacherName=t},expression:"teacherName"}})],1),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),a("div",{staticStyle:{"margin-top":"1rem"}},[a("el-table",{ref:"table",staticClass:"table",attrs:{data:e.list},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{label:"教师照片"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"50px",height:"50px","object-fit":"contain"},attrs:{src:e.row.photo,alt:"图片未加载"}})]}}],null,!1,3686283370)}),a("el-table-column",{attrs:{prop:"name",label:"教师名称"}}),a("el-table-column",{attrs:{prop:"note",label:"教师简介"}}),a("el-table-column",{attrs:{label:"选择"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.select(t.$index,t.row)}}},[e._v("选择")])]}}],null,!1,2722384122)})],1)],1)])]):e._e()},i=[],s=(a("7f7f"),{name:"teacherlist",props:{show:{type:Boolean,value:!1}},data:function(){return{teacherName:"",pageNum:1,pageSize:10,list:[],totalPage:1}},created:function(){this.getList()},methods:{handleSearch:function(){this.getList()},closeThis:function(){this.$emit("close")},getList:function(){var e=this,t={teacherName:this.teacherName,pageNum:this.pageNum,pageSize:this.pageSize};this.axios.get("/manager/teacherManagement/obtianTeacher",{params:t}).then((function(t){console.log(t),e.list=t.data.contents,e.totalPage=t.data.page.pages}))},handleSelectionChange:function(){},select:function(e,t){this.$emit("select",{id:t.id,name:t.name})}}}),l=s,r=(a("d99a"),a("2877")),o=Object(r["a"])(l,n,i,!1,null,null,null);t["a"]=o.exports},"89a8":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 套餐-课程管理\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"flex-row"},[a("div",{staticStyle:{width:"47.5%"}},[a("div",{staticClass:"handle-box display_flex between"},[a("span",[e._v(e._s(e.name))]),a("span",[e._v("总价：¥"+e._s(e.totalMoney))])])])]),a("div",{staticClass:"flex-row"},[a("div",{staticStyle:{width:"47.5%"}},[a("div",{staticClass:"handle-box display_flex between"},[a("div",{staticClass:"mt-bottom"},[e._v("课程列表")]),a("div",{staticClass:"display_flex"},[a("el-input",{staticClass:"m-r-20",attrs:{placeholder:"请输入课程名称"},model:{value:e.query.courseName,callback:function(t){e.$set(e.query,"courseName",t)},expression:"query.courseName"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"courseName",label:"课程名称",width:"350"}}),a("el-table-column",{attrs:{label:"状态",prop:"publish",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s("0"==t.row.publish?"下架":"发布"))])]}}])}),a("el-table-column",{attrs:{label:"价格",prop:"price",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("￥"+e._s(t.row.price))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.addClass(t.$index,t.row)}}},[e._v("添加")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pageNum,"page-size":10,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1),a("div",{staticStyle:{width:"47.5%"}},[a("div",{staticClass:"mt-bottom-select"},[e._v("已选课程列表")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataSelectLoading,expression:"dataSelectLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.cData,border:"","header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{prop:"courseName",label:"课程名称",width:"350"}}),a("el-table-column",{attrs:{label:"状态",prop:"publish",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s("0"==t.row.publish?"下架":"发布"))])]}}])}),a("el-table-column",{attrs:{label:"价格",prop:"price",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("￥"+e._s(t.row.price))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger"},on:{click:function(a){return e.delClass(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.pageNumSelect,"page-size":e.pageSize,total:e.pageTotalSelect},on:{"current-change":e.handlePageChangeSelect}})],1)],1)]),a("div",{staticClass:"flex-right"},[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:!e.isCheck,expression:"!isCheck"}],attrs:{type:"primary"},on:{click:e.saveClass}},[e._v("保存套餐")])],1)])])},i=[],s=(a("ac6a"),a("c5f6"),a("7f7f"),a("4a16")),l={components:{teacherlist:s["a"]},data:function(){return{query:{},tableData:[],pageTotal:0,pageNum:1,dataLoading:!1,tableDataSelect:[],pageTotalSelect:0,pageNumSelect:1,pageSize:10,start:0,end:9,dataSelectLoading:!1,id:0,name:"",isCheck:!0}},created:function(){this.id=this.$route.query.id,this.name=this.$route.query.name,this.getData({pageNum:this.pageNum,pageSize:10,publish:1}),this.getDataSelect({pageNum:1,pageSize:999,planId:this.id})},computed:{cData:function(){var e=this;return this.tableDataSelect.filter((function(t,a){return a>=e.start&&a<=e.end}))},totalMoney:function(){var e=this.tableDataSelect.reduce((function(e,t){return Number(e)+Number(t.price)}),0);return Math.floor(100*e)/100}},methods:{getData:function(e){var t=this;this.dataLoading=!0,this.axios.get("/manager/courseManagement/obtainCourse",{params:e}).then((function(e){t.dataLoading=!1,t.tableData=e.data.contents,t.pageTotal=e.data.page.total,t.pageNum=e.data.page.pageNum}))},getDataSelect:function(e){var t=this;this.dataSelectLoading=!0,this.axios.get("/manager/planManagement/obtainPlanCourse",{params:e}).then((function(e){t.dataSelectLoading=!1,e.data.planCourses.forEach((function(e){e.price=e.coursePrice})),t.tableDataSelect=e.data.planCourses,t.pageTotalSelect=e.data.pageParameter.total,t.pageNumSelect=e.data.pageParameter.pageNum}))},handleSearch:function(){this.pageNum=1;var e=this.query;e.pageNum=this.pageNum,e.pageSize=10,e.publish=1,this.getData(e)},handleDelete:function(e,t){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){var e={planId:t.planId};a.axios.get("/manager/planManagement/deletePlan",{params:e}).then((function(e){a.$message.success("删除成功"),a.getData({pageNum:1,pageSize:10})}))})).catch((function(){}))},delClass:function(e,t){var a=this,n=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(t){var i=JSON.parse(JSON.stringify(n.tableDataSelect));i.splice(e,1),n.tableDataSelect=i,n.pageTotalSelect=i.length,i.length%n.pageSize==0&&a.pageNumSelect>1&&n.handlePageChangeSelect(n.pageNumSelect-1)}))},addClass:function(e,t){var a=JSON.parse(JSON.stringify(this.tableDataSelect)),n=a.filter((function(e){return e.courseId==t.courseId}));n&&n.length?this.$message.error("已添加该课程"):(a.push(t),this.tableDataSelect=a,this.pageTotalSelect=a.length)},saveClass:function(){var e=this;if(this.isCheck){this.isCheck=!1;var t=this.tableDataSelect.map((function(e,t){var a={courseId:e.courseId,serialNumber:t+1};return a}));this.axios.post("/manager/planManagement/insertPlanDetail?planId="+this.id,t).then((function(t){setTimeout((function(){e.isCheck=!0}),500),e.$message.success("保存成功"),e.$router.go(-1)})).catch((function(t){setTimeout((function(){e.isCheck=!0}),500)}))}},handlePageChange:function(e){console.log(e),this.getData({pageNum:e,pageSize:10,publish:1})},handlePageChangeSelect:function(e){this.pageNumSelect=e,this.start=(e-1)*this.pageSize,this.end=e*this.pageSize-1}}},r=l,o=(a("e1a3"),a("2877")),c=Object(o["a"])(r,n,i,!1,null,"6730402c",null);t["default"]=c.exports},"959c":function(e,t,a){"use strict";var n=a("fc96"),i=a.n(n);i.a},c086:function(e,t,a){},d99a:function(e,t,a){"use strict";var n=a("c086"),i=a.n(n);i.a},e1a3:function(e,t,a){"use strict";var n=a("e657"),i=a.n(n);i.a},e657:function(e,t,a){},fc96:function(e,t,a){}}]);